<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>&#x5B9E;&#x9A8C;&#x8BF4;&#x660E;</title>
        <style>
</style>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
<link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        
        <script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
        
    </head>
    <body class="vscode-body vscode-light">
        <h1 id="实验说明">实验说明</h1>
<h2 id="基本信息">基本信息</h2>
<h3 id="模型">模型</h3>
<ul>
<li>ReNet-20</li>
<li>VGG-19</li>
<li>DataParallel</li>
<li>Devices: [0,1,2,3]</li>
</ul>
<h3 id="数据集">数据集</h3>
<ul>
<li>CIFAR10</li>
<li>[512,3,32,32]</li>
</ul>
<h3 id="损失函数">损失函数</h3>
<ul>
<li>CrossEntropyLoss</li>
</ul>
<h3 id="预处理">预处理</h3>
<ul>
<li>RandomHorizontalFlip(),仅训练</li>
<li>RandomCrop(32, 4),仅训练</li>
<li>Normalize(mean=[0.485, 0.456, 0.406],std=[0.229, 0.224, 0.225])),训练与测试</li>
</ul>
<h2 id="标准训练">标准训练</h2>
<h3 id="模型名称">模型名称</h3>
<ul>
<li>resnet20</li>
<li>vgg19</li>
</ul>
<h3 id="优化器">优化器</h3>
<ul>
<li>SGD</li>
<li>轮数 = 250</li>
<li>学习率 = 0.1</li>
<li>权重衰退 = 1e-4</li>
<li>优化器计划: 100轮后学习率=0.01, 150轮后学习率=0.001</li>
<li>选出测试集精度(最)高的模型</li>
</ul>
<h3 id="测试集精度">测试集精度</h3>
<ul>
<li>resnet20:   0.9000</li>
<li>vgg19:  0.9201</li>
</ul>
<h2 id="对抗训练">对抗训练</h2>
<h3 id="对抗训练模型的名称">对抗训练模型的名称</h3>
<ul>
<li>resnet20_robust</li>
<li>vgg19_robust</li>
</ul>
<h3 id="pgd参数">PGD参数</h3>
<ul>
<li>步数 = 20</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">l_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>球体半径<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>8</mn><mi mathvariant="normal">/</mi><mn>255</mn></mrow><annotation encoding="application/x-tex">\epsilon=8/255</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">ϵ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">8</span><span class="mord">/</span><span class="mord">2</span><span class="mord">5</span><span class="mord">5</span></span></span></span></li>
<li>步长<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>2</mn><mo>∗</mo><mn>8</mn><mi mathvariant="normal">/</mi><mn>255</mn><mi mathvariant="normal">/</mi><mn>20</mn></mrow><annotation encoding="application/x-tex">\alpha = 2*8/255/20</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">8</span><span class="mord">/</span><span class="mord">2</span><span class="mord">5</span><span class="mord">5</span><span class="mord">/</span><span class="mord">2</span><span class="mord">0</span></span></span></span></li>
</ul>
<h3 id="对抗训练模型的优化器">对抗训练模型的优化器</h3>
<ul>
<li>SGD</li>
<li>轮数=120</li>
<li>学习率=0.1</li>
<li>权重衰减 = 1e-4</li>
<li>优化器计划: 50轮后学习率0.01,80轮后学习率0.001</li>
<li>选出测试集精度(最)高的模型</li>
</ul>
<h3 id="对抗训练模型的测试集精度">对抗训练模型的测试集精度</h3>
<ul>
<li>restnet20_robust:   0.8743</li>
<li>vgg19_robust:   0.8418</li>
</ul>
<h3 id="对抗pgd的精度">对抗PGD的精度</h3>
<ul>
<li>同训练参数:<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>8</mn><mi mathvariant="normal">/</mi><mn>255</mn><mo separator="true">,</mo><mi>α</mi><mo>=</mo><mn>2</mn><mo>∗</mo><mn>8</mn><mi mathvariant="normal">/</mi><mn>255</mn><mi mathvariant="normal">/</mi><mn>20</mn></mrow><annotation encoding="application/x-tex">\epsilon = 8/255,\alpha = 2*8/255/20</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">ϵ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">8</span><span class="mord">/</span><span class="mord">2</span><span class="mord">5</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">8</span><span class="mord">/</span><span class="mord">2</span><span class="mord">5</span><span class="mord">5</span><span class="mord">/</span><span class="mord">2</span><span class="mord">0</span></span></span></span>
<ul>
<li>resnet20:   0.0136</li>
<li>resnet20_robust:    0.697</li>
<li>vgg:    0.2185</li>
<li>vgg_robust:   0.7414</li>
</ul>
</li>
<li>参数放大一倍:<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>16</mn><mi mathvariant="normal">/</mi><mn>255</mn><mo separator="true">,</mo><mi>α</mi><mo>=</mo><mn>2</mn><mo>∗</mo><mn>2</mn><mo>∗</mo><mn>8</mn><mi mathvariant="normal">/</mi><mn>255</mn><mi mathvariant="normal">/</mi><mn>20</mn></mrow><annotation encoding="application/x-tex">\epsilon = 16/255,\alpha = 2*2*8/255/20</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">ϵ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">6</span><span class="mord">/</span><span class="mord">2</span><span class="mord">5</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">8</span><span class="mord">/</span><span class="mord">2</span><span class="mord">5</span><span class="mord">5</span><span class="mord">/</span><span class="mord">2</span><span class="mord">0</span></span></span></span>
<ul>
<li>resnet20: 0.0</li>
<li>resnet20_robust:  0.5217</li>
<li>vgg:   0.0624</li>
<li>vgg_robust:  0.5608</li>
</ul>
</li>
</ul>
<h3 id="对抗fgsm的精度">对抗FGSM的精度</h3>
<ul>
<li>同训练参数:<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>8</mn><mi mathvariant="normal">/</mi><mn>255</mn></mrow><annotation encoding="application/x-tex">\epsilon = 8/255</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">ϵ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">8</span><span class="mord">/</span><span class="mord">2</span><span class="mord">5</span><span class="mord">5</span></span></span></span>
<ul>
<li>resnet20:0.2681</li>
<li>resnet20_robust:0.7073</li>
<li>vgg19:0.4337</li>
<li>vgg19_robust:0.7507</li>
</ul>
</li>
<li>参数放大一倍:<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>16</mn><mi mathvariant="normal">/</mi><mn>255</mn></mrow><annotation encoding="application/x-tex">\epsilon = 16/255</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">ϵ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">6</span><span class="mord">/</span><span class="mord">2</span><span class="mord">5</span><span class="mord">5</span></span></span></span>
<ul>
<li>resnet20:0.1878</li>
<li>resnet20_robust:0.5653</li>
<li>vgg19:0.2318</li>
<li>vgg19_robust:0.6108</li>
</ul>
</li>
</ul>
<h2 id="标准训练模型与对抗训练模型的对比">标准训练模型与对抗训练模型的对比</h2>
<h3 id="关于图片的导数的可视化">关于图片的导数的可视化</h3>
<ul>
<li>第一行:原图片及其各通道</li>
<li>第二行:resnet20_robust 关于图片的导数及其各通道</li>
<li>第三行:resnet20关于图片的导数及其各通道</li>
<li>测试样本随机来源于测试集标号4670-4684,7900-7915,9900-9915</li>
</ul>
<p>注意到经过对抗训练的模型的导数图像更具有类似原图的特征</p>
<p><img src="file:////home/yihan/moss/github/EhanW/advrob-cifar10/image/grad_default.png" alt="comparison of grad"></p>
<h3 id="关于损失函数的可视化">关于损失函数的可视化</h3>
<ul>
<li>每幅图中,纵轴为损失函数值,水平面由图像的sign(梯度)方向与另一随机方向生成</li>
<li>每一行中不同的列对应不同的随机方向</li>
<li>每两行中
<ul>
<li>第一行:resnet20</li>
<li>第二行:resnet20_robust</li>
</ul>
</li>
</ul>
<p>确实可以看到经过对抗训练的模型的损失函数相对更加光滑平整,某种程度上更接近于线性</p>
<p><img src="file:////home/yihan/moss/github/EhanW/advrob-cifar10/image/loss_default.png" alt="comparison of loss surface"></p>

    </body>
    </html>